{"version":3,"file":"form.js","sources":["form.js"],"sourcesContent":["(function ($) {\r\n    $(\"form\").on('submit', function () {\r\n\r\n        let form = $(this),\r\n            emailApprove = 0;\r\n\r\n        // Удаляем предыдущие ошибки\r\n        form.find('.error').remove();\r\n        form.find('.required').removeClass('required');\r\n\r\n        let actionValue = form.find('input[name=\"action\"]').val();\r\n\r\n        // Проверка полей\r\n        form.find('input[data-required], textarea[data-required], select[data-required]').each(function () {\r\n            let errorText = $(this).attr('data-error') || 'This field is required';\r\n\r\n            if ($(this).is(':checkbox')) {\r\n                // Проверка чек-боксов\r\n                if (!$(this).is(':checked')) {\r\n                    $(this).closest('.inp-wrp').append(`<div class=\"error\">${errorText}</div>`);\r\n                    $(this).addClass('required');\r\n                }\r\n            } else {\r\n                // Проверка текстовых полей и textarea\r\n                if (!$(this).val().trim()) {\r\n                    $(this).closest('.inp-wrp').append(`<div class=\"error\">${errorText}</div>`);\r\n                    $(this).addClass('required');\r\n                }\r\n            }\r\n\r\n        });\r\n\r\n        // Проверка email (если присутствует)\r\n        form.find('input.inp-email').each(function () {\r\n            let emailInput = $(this),\r\n                pattern = /^([a-z0-9_\\.-])+@[a-z0-9-]+\\.([a-z]{2,4}\\.)?[a-z]{2,4}$/i;\r\n            if (emailInput.val().trim() && !pattern.test(emailInput.val())) {\r\n                emailInput.closest('.inp-wrp').append(`<div class=\"error\">Invalid email address</div>`);\r\n                emailInput.addClass('required');\r\n                emailApprove = 0;\r\n            } else {\r\n                emailApprove = 1;\r\n            }\r\n        });\r\n\r\n        // Если есть ошибки, отменяем отправку\r\n        if (form.find('.required').length || emailApprove === 0) {\r\n\r\n            // Не скролить, если popup form окна\r\n            const validActions = ['call', 'consult', 'work_offer', 'order_products_one_click'];\r\n            if (!validActions.includes(actionValue)) {\r\n                const $firstError = form.find('.required').first();\r\n                if ($firstError.length) {\r\n                    $('html, body').animate({\r\n                        scrollTop: $firstError.offset().top - 96 // 48px header + 24px отступ до поля\r\n                    }, 600);\r\n                }\r\n            }\r\n            return false;\r\n        }\r\n\r\n        // Ваш AJAX-запрос\r\n        $.ajax({\r\n            type: \"POST\",\r\n            url: \"/mailer/mail.php\",\r\n            data: form.serialize(),\r\n            cache: false,\r\n            success: function () {\r\n                $('#thanks-popup').show();\r\n                form[0].reset(); // Сбрасываем форму\r\n            },\r\n            error: function () {\r\n                alert('Error occurred while submitting the form.');\r\n            }\r\n        });\r\n\r\n        return false; // Предотвращаем стандартную отправку формы\r\n    });\r\n\r\n    // Удаление ошибок при фокусе/изменении\r\n    $('input, textarea, select').on('click focus change', function () {\r\n        $(this).removeClass('required');\r\n        $(this).closest('.inp-wrp').find('.error').remove();\r\n    });\r\n\r\n    // Удаление ошибки для чекбокса при изменении\r\n    $('input[type=\"checkbox\"][data-required]').on('change', function () {\r\n        if ($(this).is(':checked')) {\r\n            $(this).removeClass('required');\r\n            $(this).closest('label').find('.error').remove();\r\n        }\r\n    });\r\n\r\n    // Не передзвонювати мені для підтвердження замовлення\r\n    $('#dont-call-back').on('change', function () {\r\n        const $dontCallBackBlock = $(this).closest('.order-form').find('.order-form__dont-call-back');\r\n        if ($(this).is(':checked')) {\r\n            $dontCallBackBlock.stop(true, true).slideDown(300);\r\n        } else {\r\n            $dontCallBackBlock.stop(true, true).slideUp(900);\r\n        }\r\n    });\r\n\r\n    /**\r\n     * Инициализирует функциональность загрузки файла с возможностью выбора файла по клику на указанный элемент.\r\n     * Если длина имени выбранного файла превышает maxLength, сохраняются начало и конец строки, а середина заменяется на '...'.\r\n     *\r\n     * @param {string} triggerSelector - Селектор элемента, клик по которому вызывает выбор файла.\r\n     * @param {string} inputSelector - Селектор скрытого <input type=\"file\">.\r\n     * @param {string} textSelector - Селектор элемента, в который будет выводиться название выбранного файла.\r\n     * @param {number} [maxLength=20] - Максимальная длина текста для отображения имени файла. По умолчанию 20 символов.\r\n     */\r\n    function initFileUpload(triggerSelector, inputSelector, textSelector, maxLength = 20) {\r\n        $(triggerSelector).on('click', function () {\r\n            $(inputSelector).trigger('click');\r\n        });\r\n\r\n        $(inputSelector).on('change', function () {\r\n            let fileName = this.files[0]?.name || 'Файл не обрано';\r\n\r\n            if (fileName.length > maxLength) {\r\n                const extIndex = fileName.lastIndexOf('.');\r\n                const extension = extIndex !== -1 ? fileName.slice(extIndex) : ''; // Расширение файла\r\n                const visibleLength = maxLength - extension.length - 3; // Учёт места под '...'\r\n\r\n                if (visibleLength > 0) {\r\n                    const start = fileName.slice(0, Math.ceil(visibleLength / 2)); // Начало имени\r\n                    const end = fileName.slice(-Math.floor(visibleLength / 2)); // Конец имени\r\n                    fileName = `${start}...${end}${extension}`;\r\n                }\r\n            }\r\n\r\n            $(textSelector).text(fileName);\r\n        });\r\n    }\r\n    initFileUpload('#work_offer-drop', '#work_offer-file', '#work_offer-drop span', 40);\r\n\r\n\r\n})(jQuery);"],"names":["$","inputSelector","textSelector","maxLength","on","let","form","this","emailApprove","find","remove","removeClass","actionValue","val","each","errorText","attr","is","closest","append","addClass","trim","emailInput","test","length","includes","$firstError","first","animate","scrollTop","offset","top","ajax","type","url","data","serialize","cache","success","show","reset","error","alert","$dontCallBackBlock","stop","slideDown","slideUp","trigger","fileName","files","name","extension","start","end","extIndex","lastIndexOf","slice","visibleLength","Math","ceil","floor","text","jQuery"],"mappings":"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"}